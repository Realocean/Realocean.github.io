<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>模块导入</title>
    <link rel="stylesheet" href="../../statics/common/cascader/cascader/cascader.css" media="all">
    <link rel="stylesheet" type="text/css" href="../../statics/common/layui/css/layui.css" media="all">
    <link rel="stylesheet" type="text/css" href="../../statics/common/layui/css/autocomplete.css">
    <link rel="stylesheet" type="text/css" href="../../statics/common/layui/css/soulTable.css">
    <link rel="stylesheet" type="text/css" href="../../statics/new_css/index.css">
    <link rel="stylesheet" type="text/css" href="../../statics/new_css/fileImport.css">
    <link rel="stylesheet" type="text/css" href="../../statics/new_css/index.css">
    <link rel="stylesheet" type="text/css" href="../../statics/common/css/new_fonts/iconfont.css" media="all">
    <link rel="stylesheet" type="text/css" href="../../statics/css/common-tabs.css">
    <link rel="stylesheet" type="text/css" href="../../statics/common/css/fonts/larry-icon.css" media="all">
    <link rel="stylesheet" type="text/css" href="../../statics/css/fontdemo.css" media="all">
    <style>

        body{
            background: #f6f8f8;
        }
        /*.module-page{*/
        /*    padding:0;*/
        /*}*/

        /*.module-tab{*/
        /*    margin-top: 0;*/
        /*    border-radius: 8px;*/
        /*}*/

        /*.module-main{*/
        /*    border-radius: 8px;*/
        /*}*/

        /*.tab-item{*/
        /*    border-radius: 8px;*/
        /*}*/
        /*.el-tabs__item {*/
        /*    color: #000 !important;*/
        /*}*/
        /*.el-tabs__item.is-active {*/
        /*    color: #3FACB3 !important;*/
        /*}*/

        /*.importResult{*/
        /*    display: flex;*/
        /*    justify-content: space-between;*/
        /*    align-items: center;*/
        /*    padding: 20px;*/
        /*    border: 1px solid #CDCDCD;*/
        /*    border-radius: 8px;*/
        /*    margin-bottom: 10px;*/
        /*}*/

        /*.importItem{*/
        /*    display: flex;*/
        /*    flex: 1;*/

        /*}*/

        /*.el-button+.el-button {*/
        /*    margin-left: 0px;*/
        /*}*/

        /*.layui-tab-item .el-button{*/
        /*    padding: 0 0 10px 0;*/
        /*}*/

        /*.import—download-box .layui-tab-content{*/
        /*    padding: 0;*/
        /*}*/

        /*.i-rotate{*/
        /*    animation: rotate 2s linear infinite;*/
        /*    -webkit-animation: rotate 2s linear infinite;*/
        /*}*/

        /*@keyframes rotate {*/
        /*    0% {*/
        /*        transform: rotate(0);*/
        /*    }*/

        /*    25% {*/
        /*        transform: rotate(90deg);*/
        /*    }*/

        /*    50% {*/
        /*        transform: rotate(180deg);*/
        /*    }*/

        /*    75% {*/
        /*        transform: rotate(270deg);*/
        /*    }*/

        /*    100% {*/
        /*        transform: rotate(360deg);*/
        /*    }*/
        /*}*/

        #app{
            display: flex;
            flex-direction: column;
        }

        .card-wrap{
            border-radius: 8px;
            margin-bottom: 15px;
            padding: 16px 20px;
            background: #fff;
        }

        .flex-center{
            display: flex;
            align-items: center;
        }

        .main-title{
            color: #333;
            font-size: 14px;
            white-space: nowrap;
            margin-right: 10px;
            font-weight: bold;
            margin-top: 5px;
        }

        .main-tab-item{
            padding: 6px 16px;
            color: #333;
            background: #FFFFFF;
            border-radius: 4px;
            border: 1px solid #BED7DE;
            margin-right: 20px;
            font-size: 14px;
            cursor: pointer;
            text-align: center;
            margin-bottom: 12px;
        }

        .main-tab-active{
            background: #3FACB3;
            border: 1px solid #3FACB3;
            color: white;
        }

        ::-webkit-scrollbar {
            display: none;
        }

        .flex-col{
            display: flex;
            flex-direction: column;
        }


        .item-title{
            font-size: 14px;
            position: relative;
            margin-left: 16px;
            color: #333;
            font-weight: bold;
        }

        .item-title:before {
            content: '';
            position: absolute;
            border-radius: 6px;
            height: 16px;
            width: 4px;
            top: 3px;
            left: -12px;
            background: #3facb3;
            transform: rotate(15deg);
        }

        .line{
            height: 1px;
            background: #EFEFEF;
            margin: 16px -20px 0;

        }

        .tab-wrap{
            padding-bottom: 6px;
            flex-direction: row;
            display: flex;
        }

        .tab-item-wrap{
            flex-wrap: wrap;
            flex-direction: row;
            display: inline-flex;
        }

        .sub-wrap{
            display: flex;
            margin-top: 20px;
        }

        .sub-number{
            width: 20px;
            height: 20px;
            line-height: 20px;
            text-align: center;
            background: #3FACB3;
            color: white;
            margin-top: 1px;
            border-radius: 90px;
        }
        .sub-title{
            color: #333;
            font-size: 14px;
        }

        .top10{
            margin-top: 10px;
        }

        .top20{
            margin-top: 20px;
        }

        .sub-wrap-right{
            display: flex;
            flex-direction: column;
            margin-left: 8px;
        }

        .sub-tip{
            color: #999999;
            font-size: 12px;
            white-space: nowrap;
            margin: 5px 0 8px 0;
        }

        .down-btn{
            height: 32px;
            line-height: 32px;
            text-align: center;
            border-radius: 4px;
            border: 1px solid #3FACB3;
            color: #3FACB3;
            padding: 0 15px;
            font-size: 14px;
            margin-right: 10px;
            cursor: pointer;
        }

        .green-text{
            font-size: 14px;
            color: #3FACB3;
            cursor: pointer;
            white-space: nowrap;
        }

        .gray-bg{
            width: 50%;
            display: flex;
            background: #F7F7F7;
            border-radius: 4px;
            padding: 16px 16px 10px;
            margin-top: 16px;
        }

        .info{
            color: #666;
            margin-top: -2px;
            font-size: 12px;
            font-weight: bold;
        }

        .import-status {
            border-radius: 6px;
            height: 6px;
            width: 6px;
            margin-right: 3px;
            background: #3facb3;
        }

        .importing{
            background: #FAAD14;
        }

        .importsuc{
            background: #52C41A;
        }

        .importfail{
            background: #FF4D4F;
        }

        .right10{
            margin-right: 10px;
        }

        .el-select .el-input.is-focus .el-input__inner {
            border-color: #3facb3;
        }

        .el-select .el-input__inner:focus {
            border-color: #3facb3;
        }

        .el-select-dropdown__item.selected {
            color: #3facb3;
        }
        .el-pager li.active,
        .el-pager li:hover{
            color: #3facb3;
        }
        .el-pagination__sizes .el-input .el-input__inner:hover {
            border-color: #3facb3;
        }

        .upload-demo{
            border-radius: 4px;
            margin-top: 16px;
            margin-bottom: 0;
        }

        .upload-file{
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
            padding: 0;
        }

        .uploading-icon{
            width: 34px;
            height: 41px;
        }

        .zip-tip{
            color: #333333;
            font-size: 14px;
            margin-top: 16px;
        }

        .reminder-box{
            margin: 6px 0 0;
            border-radius: 4px;
            background: #F7F7F7;
            width: 70%;
        }

        .reminder-tip-text{
            margin-left: 22px;
            margin-bottom: 10px;
        }

        .reminder-tab{
            margin: 15px 22px 5px;
            justify-content: space-between;
        }
        .reminder-box span{
            font-weight: bold;
        }
        .reminder-box span,
        .reminder-box p{
            color: #666;
        }

        .reminder-tip{
            color: #999 !important;
        }

        .reminder-tip-icon{
            width: 43px;
            height: 43px;
        }

    </style>

</head>
<body>
<div id="app">

    <div class="card-wrap tab-wrap">
        <span class="main-title ">数据导入</span>

        <div class="tab-item-wrap">
            <div class="main-tab-item" :class="currentTab==index?'main-tab-active':''" @click="tabChange(index)"
                v-for="(item,index) in tab">{{item}}
            </div>
        </div>
    </div>

    <keep-alive>
        <component v-if="status!=5" :is="currentTabComponent" :status="status" :import-url="importUrl" :current-tab="currentTab" @change-status="changeStatus"
                   @import-complete="importComplete"
                   :progress="progress"></component>
        <import-upload v-else :import-url="importUrl" @import-complete="importComplete"></import-upload>
    </keep-alive>


    <div class="card-wrap flex-col">
        <span class="item-title">导入结果</span>

        <div class="line"></div>

        <el-table border
                  :header-cell-style="{'background-color':'#f6f8f8','color':'#000'}"
                  :data="importRecords"
                  style="width: 100%;margin-top: 15px">
            <el-table-column
                    prop="importBizTypeStr"
                    label="导入类型"
                    min-width="100px"
                    show-overflow-tooltip
                    align="center">
            </el-table-column>
            <el-table-column
                    prop="name"
                    label="导入状态"
                    min-width="80px"
                    show-overflow-tooltip
                    align="center">
                <template slot-scope="{row}">
                    <span class="flex-center" style="justify-content: center">
                        <span class="import-status" :class="row.importStatus==0?'importing':row.importStatus==1?'importsuc':'importfail'"></span>
                        <span>{{row.importStatus==0?'导入中':row.importStatus==1?'导入成功':'导入失败'}}</span>
                    </span>
                </template>
            </el-table-column>
            <el-table-column
                    min-width="300px"
                    show-overflow-tooltip
                    align="center"
                    prop="importBizTypeStr"
                    label="导入结果">
                <template slot-scope="{row}">
                    <span >{{row.remark||'--'}}</span>
                </template>
            </el-table-column>
            <el-table-column
                    min-width="85px"
                    show-overflow-tooltip
                    align="center"
                    prop="createUserName"
                    label="导入人">
                <template slot-scope="{row}">
                    <span>{{row.createUserName}}
                    </span>
                </template>
            </el-table-column>
            <el-table-column
                    min-width="108px"
                    show-overflow-tooltip
                    align="center"
                    prop="createTime"
                    label="导入时间">
                <template slot-scope="{row}">
                    <span>{{row.createTime}}
                    </span>
                </template>
            </el-table-column>
            <el-table-column
                    v-if="currentTab != 8"
                    min-width="80px"
                    show-overflow-tooltip
                    align="center"
                    label="操作">
                <template slot-scope="{row}">
                    <span v-if="row.importStatus==2" @click="downError(row)" class="green-text">下载错误文件
                    </span>
                </template>
            </el-table-column>
        </el-table>
        <div style="margin: 10px 0;display: flex;justify-content: flex-end">
            <el-pagination
                    :current-page="page"
                    :page-size="limit"
                    :page-sizes="[10, 50, 100, 200]"
                    :small="false"
                    :disabled="false"
                    :background="false"
                    layout="total, sizes, prev, pager, next, jumper"
                    :total="totalCount"
                    @size-change="handleSizeChange"
                    @current-change="handleCurrentChange"
            ></el-pagination>
        </div>
    </div>

    <el-dialog title="失败数据" :visible.sync="dialogTableVisible" width="80%">
        <el-table :data="importList" border>
             <!--车辆-->
            <template v-if="currentRecordObj&&currentRecordObj.type=='cldr'">
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="engineNo" key="engineNo" align="center" label="发动机号码" min-width="150"></el-table-column>
                <el-table-column property="brandName" key="brandName" align="center" label="车辆品牌" min-width="150"></el-table-column>
                <el-table-column property="seriesName" key="seriesName" align="center" label="车系" min-width="150"></el-table-column>
                <el-table-column property="modelName" key="modelName" align="center" label="车型" min-width="150"></el-table-column>
                <el-table-column property="deptName" key="deptName" align="center" label="车辆归属" min-width="150"></el-table-column>
                <el-table-column property="depotName" key="depotName" align="depotName" label="车辆所在仓库" min-width="150"></el-table-column>
                <el-table-column property="supplierName" key="supplierName" align="center" label="供应商" min-width="150"></el-table-column>
                <el-table-column property="storageTime" key="storageTime" align="center" label="车辆入库时间" min-width="150"></el-table-column>
                <el-table-column property="remark" key="remark" align="center" label="车辆备注" min-width="150"></el-table-column>
                <el-table-column property="initMeligile" key="initMeligile" align="center" label="车辆采购初始里程数" min-width="150"></el-table-column>
                <el-table-column property="carColor" key="carColor" align="center" label="车辆颜色" min-width="150"></el-table-column>
                <el-table-column property="registrationAddr" key="registrationAddr" align="center" label="上牌地址" min-width="150"></el-table-column>
                <el-table-column property="sideDoor" key="sideDoor" align="center" label="有无侧门" min-width="150"></el-table-column>
                <el-table-column property="nextMaintenanceDate" key="nextMaintenanceDate" align="center" label="下次保养时间" min-width="150"></el-table-column>
                <el-table-column property="nextMaintenance" key="nextMaintenance" align="center" label="下次保养里程/km" min-width="150"></el-table-column>
                <el-table-column property="statusStr" key="statusStr" align="center" label="车辆状态" min-width="150"></el-table-column>
                <el-table-column property="carOwner" key="carOwner" align="center" label="行驶证所有人" min-width="150"></el-table-column>
                <el-table-column property="documentNo" key="documentNo" align="center" label="档案编号" min-width="150"></el-table-column>
                <el-table-column property="licenseDate" key="licenseDate" align="center" label="发证日期" min-width="150"></el-table-column>
            </template>
             <!--车辆保险-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='bxdr'">
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="compulsoryCompany" key="compulsoryCompany" align="center" label="交强险保险公司" min-width="150"></el-table-column>
                <el-table-column property="compulsoryNo" key="compulsoryNo" align="center" label="交强险保单号" min-width="150"></el-table-column>
                <el-table-column property="compulsoryStartTime" key="compulsoryStartTime" align="center" label="交强险开始时间" min-width="150"></el-table-column>
                <el-table-column property="compulsoryEndTime" key="compulsoryEndTime" align="center" label="交强险结束时间" min-width="150"></el-table-column>
                <el-table-column property="compulsoryAmount" key="compulsoryAmount" align="center" label="交强险费用" min-width="150"></el-table-column>
                <el-table-column property="compulsoryRemark" key="compulsoryRemark" align="center" label="交强险备注" min-width="150"></el-table-column>
                <el-table-column property="carrierCompany" key="carrierCompany" align="center" label="承运险保险公司" min-width="150"></el-table-column>
                <el-table-column property="carrierNo" key="carrierNo" align="center" label="承运险保单号" min-width="150"></el-table-column>
                <el-table-column property="carrierStartTime" key="carrierStartTime" align="center" label="承运险开始时间" min-width="150"></el-table-column>
                <el-table-column property="carrierEndTime" key="carrierEndTime" align="center" label="承运险结束时间" min-width="150"></el-table-column>
                <el-table-column property="carrierAmount" key="carrierAmount" align="center" label="承运险费用" min-width="150"></el-table-column>
                <el-table-column property="carrierRemark" key="carrierRemark" align="center" label="承运险备注" min-width="150"></el-table-column>
                <el-table-column property="commercialCompany" key="commercialCompany" align="center" label="商业险保险公司" min-width="150"></el-table-column>
                <el-table-column property="commercialNo" key="commercialNo" align="center" label="商业险保单号" min-width="150"></el-table-column>
                <el-table-column property="commercialStartTime" key="commercialStartTime" align="center" label="商业险开始时间" min-width="150"></el-table-column>
                <el-table-column property="commercialEndTime" key="commercialEndTime" align="center" label="商业险结束时间" min-width="150"></el-table-column>
                <el-table-column property="insuranceTypeName" key="insuranceTypeName" align="center" label="商业险种/保额（万）/保费（元）" min-width="150"></el-table-column>
                <el-table-column property="commercialRemark" key="commercialRemark" align="center" label="商业险备注" min-width="150"></el-table-column>
                <el-table-column property="compulsoryPayableTime" key="compulsoryPayableTime" align="center" label="交强险应付时间" min-width="150"></el-table-column>
                <el-table-column property="carrierPayableTime" key="carrierPayableTime" align="center" label="承运险险应付时间" min-width="150"></el-table-column>
                <el-table-column property="commercialPayableTime" key="commercialPayableTime" align="center" label="商业险应付时间" min-width="150"></el-table-column>
            </template>
             <!--车辆年检-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='clnjdr'">
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="thisTimeInspectionTime" key="thisTimeInspectionTime" align="center" label="本次年检时间" min-width="150"></el-table-column>
                <el-table-column property="nextInspectionTime" key="nextInspectionTime" align="center" label="下次年检时间" min-width="150"></el-table-column>
                <el-table-column property="inspectionAmount" key="inspectionAmount" align="center" label="年检费用/元" min-width="150"></el-table-column>
                <el-table-column property="inspectionAgent" key="inspectionAgent" align="center" label="年审代理人" min-width="150"></el-table-column>
                <el-table-column property="remark" key="remark" align="center" label="年检备注" min-width="150"></el-table-column>
            </template>
            <!--车辆保养-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='bydr'">
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="serviceSite" key="serviceSite" align="center" label="服务站名称" min-width="150"></el-table-column>
                <el-table-column property="currentMile" key="currentMile" align="center" label="当前公里数" min-width="150"></el-table-column>
                <el-table-column property="nextMile" key="nextMile" align="center" label="下次保养公里数" min-width="150"></el-table-column>
                <el-table-column property="maintenanceDate" key="maintenanceDate" align="center" label="本次保养时间" min-width="150"></el-table-column>
                <el-table-column property="nextDate" key="nextDate" align="center" label="下次保养时间" min-width="150"></el-table-column>
                <el-table-column property="maintenanceTypeName" key="maintenanceTypeName" align="center" label="保养项目/保养金额（元）" min-width="150"></el-table-column>
            </template>
            <!--车辆出险-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='cxdr'">
                <el-table-column property="carPlateNo" key="carPlateNo" align="center" label="车牌号" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="receiveDate" key="receiveDate" align="center" label="接收时间" min-width="150"></el-table-column>
                <el-table-column property="outDate" key="outDate" align="center" label="出险时间" min-width="150"></el-table-column>
                <el-table-column property="outAddr" key="outAddr" align="center" label="出险地点" min-width="150"></el-table-column>
                <el-table-column property="reporter" key="reporter" align="center" label="报案人" min-width="150"></el-table-column>
                <el-table-column property="outReason" key="outReason" align="center" label="出险经过及原因" min-width="150"></el-table-column>
                <el-table-column property="outLevel" key="outLevel" align="center" label="事故等级" min-width="150"></el-table-column>
                <el-table-column property="sxInsuranceCompanyName" key="sxInsuranceCompanyName" align="center" label="商业险保险公司" min-width="150"></el-table-column>
                <el-table-column property="sxIsPay" key="sxIsPay" align="center" label="商业险是否赔付" min-width="150"></el-table-column>
                <el-table-column property="sxPayFee" key="sxPayFee" align="center" label="商业险赔付金额（元）" min-width="150"></el-table-column>
                <el-table-column property="sxPayDate" key="sxPayDate" align="center" label="商业险赔付时间" min-width="150"></el-table-column>
                <el-table-column property="sxCustomerPaymentAmount" key="sxCustomerPaymentAmount" align="center" label="商业险客户赔付金额（元）" min-width="150"></el-table-column>
                <el-table-column property="qxInsuranceCompanyName" key="qxInsuranceCompanyName" align="center" label="交强险保险公司" min-width="150"></el-table-column>
                <el-table-column property="qxIsPay" key="qxIsPay" align="center" label="交强险是否赔付" min-width="150"></el-table-column>
                <el-table-column property="qxPayFee" key="qxPayFee" align="center" label="交强险赔付金额（元)" min-width="150"></el-table-column>
                <el-table-column property="qxPayDate" key="qxPayDate" align="center" label="交强险赔付时间" min-width="150"></el-table-column>
                <el-table-column property="qxCustomerPaymentAmount" key="qxCustomerPaymentAmount" align="center" label="交强险客户赔付金额（元）" min-width="150"></el-table-column>
                <el-table-column property="responsibleParty" key="responsibleParty" align="center" label="责任方" min-width="150"></el-table-column>
                <el-table-column property="remark" key="remark" align="center" label="备注" min-width="150"></el-table-column>
            </template>
            <!--车辆维修-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='wxdr'">
                <el-table-column property="carPlateNo" key="carPlateNo" align="center" label="车牌号" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="repairStartDate" key="repairStartDate" align="center" label="维修开始时间" min-width="150"></el-table-column>
                <el-table-column property="faultDesc" key="faultDesc" align="center" label="故障描述" min-width="150"></el-table-column>
                <el-table-column property="serviceName" key="serviceName" align="center" label="维修厂名称" min-width="150"></el-table-column>
                <el-table-column property="repairShopQuotation" key="repairShopQuotation" align="center" label="维修厂报价（元）" min-width="150"></el-table-column>
                <el-table-column property="repairContent" key="repairContent" align="center" label="维修内容" min-width="150"></el-table-column>
                <el-table-column property="userPay" key="userPay" align="center" label="维修价格用户支付金额（元）" min-width="150"></el-table-column>
                <el-table-column property="platformPay" key="platformPay" align="center" label="维修价格平台支付金额（元）" min-width="150"></el-table-column>
                <el-table-column property="insurancePay" key="insurancePay" align="center" label="维修价格保险支付金额（元）" min-width="150"></el-table-column>
                <el-table-column property="totalPay" key="totalPay" align="center" label="总金额（元）" min-width="150"></el-table-column>
                <el-table-column property="isSpareCar" key="isSpareCar" align="center" label="是否提供备用车" min-width="150"></el-table-column>
                <el-table-column property="spareCarNo" key="spareCarNo" align="center" label="备用车车牌号" min-width="150"></el-table-column>
                <el-table-column property="repairStatus" key="repairStatus" align="center" label="维修状态" min-width="150"></el-table-column>
                <el-table-column property="remark" key="remark" align="center" label="备注" min-width="150"></el-table-column>
                <el-table-column property="maintenanceItemInfoListStr" key="maintenanceItemInfoListStr" align="center" label="项目内容/项目金额" min-width="150"></el-table-column>
            </template>
            <!--客户-企业-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='qykhdr'">
                <el-table-column property="customerName" key="customerName" align="center" label="客户姓名" min-width="150"></el-table-column>
                <el-table-column property="contactPerson" key="contactPerson" align="center" label="联系人" min-width="150"></el-table-column>
                <el-table-column property="contactMobile" key="contactMobile" align="center" label="联系电话" min-width="150"></el-table-column>
                <el-table-column property="address" key="address" align="center" label="公司地址" min-width="150"></el-table-column>
                <el-table-column property="license" key="license" align="center" label="营业执照" min-width="150"></el-table-column>
                <el-table-column property="email" key="email" align="center" label="邮箱" min-width="150"></el-table-column>
                <el-table-column property="channelName" key="channelName" align="center" label="所属渠道" min-width="150"></el-table-column>
                <el-table-column property="businessPersonShow" key="businessPersonShow" align="center" label="所属业务负责人" min-width="150"></el-table-column>
                <el-table-column property="note" key="note" align="center" label="备注" min-width="150"></el-table-column>
            </template>
            <!--客户-个人-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='grkhdr'">
                <el-table-column property="customerName" key="customerName" align="center" label="客户姓名" min-width="150"></el-table-column>
                <el-table-column property="contactMobile" key="contactMobile" align="center" label="联系电话" min-width="150"></el-table-column>
                <el-table-column property="signedDriver" key="signedDriver" align="center" label="是否签约司机" min-width="150"></el-table-column>
                <el-table-column property="joiningTime" key="joiningTime" align="center" label="入职日期" min-width="150"></el-table-column>
                <el-table-column property="idCardNo" key="idCardNo" align="center" label="身份证号" min-width="150"></el-table-column>
                <el-table-column property="address" key="address" align="center" label="联系地址" min-width="150"></el-table-column>
                <el-table-column property="driverNo" key="driverNo" align="center" label="驾驶证号" min-width="150"></el-table-column>
                <el-table-column property="driverValidity" key="driverValidity" align="center" label="驾驶证有效期" min-width="150"></el-table-column>
                <el-table-column property="nowAddress" key="nowAddress" align="center" label="现住地址" min-width="150"></el-table-column>
                <el-table-column property="emergencyPerson" key="emergencyPerson" align="center" label="紧急联系人" min-width="150"></el-table-column>
                <el-table-column property="emergencyMobile" key="emergencyMobile" align="center" label="紧急联系电话" min-width="150"></el-table-column>
                <el-table-column property="email" key="email" align="center" label="邮箱" min-width="150"></el-table-column>
                <el-table-column property="bankAccount" key="bankAccount" align="center" label="银行账号" min-width="150"></el-table-column>
                <el-table-column property="affiliatedBank" key="affiliatedBank" align="center" label="所属银行" min-width="150"></el-table-column>
                <el-table-column property="channelName" key="channelName" align="center" label="所属渠道" min-width="150"></el-table-column>
                <el-table-column property="businessPersonShow" align="center" label="业务负责人" min-width="150"></el-table-column>
                <el-table-column property="note" key="note" align="center" label="备注" min-width="150"></el-table-column>
            </template>
            <!--车辆订单-经租-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='jzdr'">
                <el-table-column property="lessorName" key="lessorName" align="center" label="出租方" min-width="150"></el-table-column>
                <el-table-column property="customerType" key="customerType" align="center" label="客户类型" min-width="150"></el-table-column>
                <el-table-column property="customerName" key="customerName" align="center" label="客户名称" min-width="150"></el-table-column>
                <el-table-column property="contactPerson" key="contactPerson" align="center" label="联系人" min-width="150"></el-table-column>
                <el-table-column property="customerTel" key="customerTel" align="center" label="联系电话" min-width="150"></el-table-column>
                <el-table-column property="licenseNumber" key="licenseNumber" align="center" label="营业执照号" min-width="150"></el-table-column>
                <el-table-column property="idcard" key="idcard" align="center" label="身份证号" min-width="150"></el-table-column>
                <el-table-column property="customerAddr" key="customerAddr" align="center" label="联系地址" min-width="150"></el-table-column>
                <el-table-column property="customerDesc" key="customerDesc" align="center" label="客户备注" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>

                <el-table-column property="cashDeposit" key="cashDeposit" align="center" label="保证金/元/台" min-width="150"></el-table-column>
<!--                <el-table-column property="monthlyRent" align="center" label="保证金分期数" min-width="150"></el-table-column>-->
                <el-table-column property="monthlyRent" key="monthlyRent" align="center" label="租金/元/台" min-width="150"></el-table-column>
                <el-table-column property="freeDays" key="freeDays" align="center" label="免费用车天数" min-width="150"></el-table-column>
                <el-table-column property="paymentMethod" key="paymentMethod" align="center" label="付款方式" min-width="150"></el-table-column>
                <el-table-column property="timeStartRent" key="timeStartRent" align="center" label="租赁开始时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinishRent" key="timeFinishRent" align="center" label="租赁结束时间" min-width="150"></el-table-column>
                <el-table-column property="paymentDay" key="paymentDay" align="center" label="还款日" min-width="150"></el-table-column>
                <el-table-column property="orderDesc" key="orderDesc" align="center" label="订单备注" min-width="150"></el-table-column>
                <el-table-column property="operationName" key="operationName" align="center" label="提单人员" min-width="150"></el-table-column>
                <el-table-column property="timeDelivery" key="timeDelivery" align="center" label="交车时间" min-width="150"></el-table-column>
<!--                <el-table-column property="address" align="center" label="已退车时间" min-width="150"></el-table-column>-->
                <el-table-column property="insuranceItems" key="insuranceItems" align="center" label="车辆已购保险" min-width="150"></el-table-column>
                <el-table-column property="deliveryOperationName" key="deliveryOperationName" align="center" label="交车人员" min-width="150"></el-table-column>
                <el-table-column property="deliveryDesc" key="deliveryDesc" align="center" label="交车备注" min-width="150"></el-table-column>
                <el-table-column property="contractCode" key="contractCode" align="center" label="合同编号" min-width="150"></el-table-column>
                <el-table-column property="timeStart" key="timeStart" align="center" label="合同生效时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinish" key="timeFinish" align="center" label="合同终止时间" min-width="150"></el-table-column>
                <el-table-column property="desc" key="desc" align="center" label="合同备注" min-width="150"></el-table-column>
            </template>
            <!--车辆订单-以租代购-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='yzdgdr'">
                <el-table-column property="lessorName" key="lessorName" align="center" label="出租方" min-width="150"></el-table-column>
                <el-table-column property="customerType" key="customerType" align="center" label="客户类型" min-width="150"></el-table-column>
                <el-table-column property="customerName" key="customerName" align="center" label="客户名称" min-width="150"></el-table-column>
                <el-table-column property="contactPerson" key="contactPerson" align="center" label="联系人" min-width="150"></el-table-column>
                <el-table-column property="customerTel" key="customerTel" align="center" label="联系电话" min-width="150"></el-table-column>
                <el-table-column property="licenseNumber" key="licenseNumber" align="center" label="营业执照号" min-width="150"></el-table-column>
                <el-table-column property="idcard" key="idcard" align="center" label="身份证号" min-width="150"></el-table-column>
                <el-table-column property="customerAddr" key="customerAddr" align="center" label="联系地址" min-width="150"></el-table-column>
                <el-table-column property="customerDesc" key="customerDesc" align="center" label="客户备注" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>

                <el-table-column property="servicingFee" key="servicingFee" align="center" label="整备费/元/台" min-width="150"></el-table-column>
<!--                <el-table-column property="address" align="center" label="整备费分期数" min-width="150"></el-table-column>-->
                <el-table-column property="monthlyRent" key="monthlyRent" align="center" label="还款/元/台" min-width="150"></el-table-column>
                <el-table-column property="balancePayment" key="balancePayment" align="center" label="尾款金额" min-width="150"></el-table-column>
                <el-table-column property="address" align="center" label="尾款分期数" min-width="150"></el-table-column>

                <el-table-column property="timeStartRent" key="timeStartRent" align="center" label="租赁开始时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinishRent" key="timeFinishRent" align="center" label="租赁结束时间" min-width="150"></el-table-column>
                <el-table-column property="paymentMethod" key="paymentMethod" align="center" label="付款方式" min-width="150"></el-table-column>
                <el-table-column property="paymentDay" key="paymentDay" align="center" label="付款日" min-width="150"></el-table-column>
                <el-table-column property="insuranceItems" key="insuranceItems" align="center" label="车辆已购保险" min-width="150"></el-table-column>
                <el-table-column property="channelName" key="channelName" align="center" label="所属渠道" min-width="150"></el-table-column>
                <el-table-column property="chlRebate" key="chlRebate" align="center" label="渠道返利" min-width="150"></el-table-column>
                <el-table-column property="orderDesc" key="orderDesc" align="center" label="订单备注" min-width="150"></el-table-column>

                <el-table-column property="operationName" key="operationName" align="center" label="提单人员" min-width="150"></el-table-column>
                <el-table-column property="timeDelivery" key="timeDelivery" align="center" label="交车时间" min-width="150"></el-table-column>
<!--                <el-table-column property="address" align="center" label="已退车时间" min-width="150"></el-table-column>-->
                <el-table-column property="timeTransferEstimated" key="timeTransferEstimated" align="center" label="预计过户时间" min-width="150"></el-table-column>
                <el-table-column property="deliveryOperationName" key="deliveryOperationName" align="center" label="交车人员" min-width="150"></el-table-column>
                <el-table-column property="deliveryDesc" key="deliveryDesc" align="center" label="交车备注" min-width="150"></el-table-column>

                <el-table-column property="contractCode" key="contractCode" align="center" label="合同编号" min-width="150"></el-table-column>
                <el-table-column property="timeStart" key="timeStart" align="center" label="合同生效时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinish" key="timeFinish" align="center" label="合同终止时间" min-width="150"></el-table-column>
                <el-table-column property="desc" key="desc" align="center" label="合同备注" min-width="150"></el-table-column>
            </template>
            <!--车辆订单-融租-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='rzdr'">
                <el-table-column property="lessorName" key="lessorName" align="center" label="出租方" min-width="150"></el-table-column>
                <el-table-column property="customerType" key="customerType" align="center" label="客户类型" min-width="150"></el-table-column>
                <el-table-column property="customerName" key="customerName" align="center" label="客户名称" min-width="150"></el-table-column>
                <el-table-column property="contactPerson" key="contactPerson" align="center" label="联系人" min-width="150"></el-table-column>
                <el-table-column property="customerTel" key="customerTel" align="center" label="联系电话" min-width="150"></el-table-column>
                <el-table-column property="licenseNumber" key="licenseNumber" align="center" label="营业执照号" min-width="150"></el-table-column>
                <el-table-column property="idcard" key="idcard" align="center" label="身份证号" min-width="150"></el-table-column>
                <el-table-column property="customerAddr" key="customerAddr" align="center" label="联系地址" min-width="150"></el-table-column>
                <el-table-column property="customerDesc" key="customerDesc" align="center" label="客户备注" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>

                <el-table-column property="downPayment" key="downPayment" align="center" label="首付款/元/台" min-width="150"></el-table-column>
<!--                <el-table-column property="address" align="center" label="首付款分期数" min-width="150"></el-table-column>-->
                <el-table-column property="monthlyRent" key="monthlyRent" align="center" label="还款/元/台" min-width="150"></el-table-column>
                <el-table-column property="financeCompanyName" key="financeCompanyName" align="center" label="金融公司名称" min-width="150"></el-table-column>
                <el-table-column property="balancePayment" key="balancePayment" align="center" label="尾款金额" min-width="150"></el-table-column>
<!--                <el-table-column property="address" align="center" label="尾款分期数" min-width="150"></el-table-column>-->

                <el-table-column property="timeStartRent" key="timeStartRent" align="center" label="租赁开始时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinishRent" key="timeFinishRent" align="center" label="租赁结束时间" min-width="150"></el-table-column>
                <el-table-column property="insuranceItems" key="insuranceItems" align="center" label="车辆已购保险" min-width="150"></el-table-column>
                <el-table-column property="channelName" key="channelName" align="center" label="所属渠道" min-width="150"></el-table-column>
                <el-table-column property="orderDesc" key="orderDesc" align="center" label="订单备注" min-width="150"></el-table-column>

                <el-table-column property="operationName" key="operationName" align="center" label="提单人员" min-width="150"></el-table-column>
                <el-table-column property="timeDelivery" key="timeDelivery" align="center" label="交车时间" min-width="150"></el-table-column>
<!--                <el-table-column property="address" align="center" label="已退车时间" min-width="150"></el-table-column>-->
                <el-table-column property="timeTransferEstimated" key="timeTransferEstimated" align="center" label="预计过户时间" min-width="150"></el-table-column>
                <el-table-column property="deliveryOperationName" key="deliveryOperationName" align="center" label="交车人员" min-width="150"></el-table-column>
                <el-table-column property="deliveryDesc" key="deliveryDesc" align="center" label="交车备注" min-width="150"></el-table-column>

                <el-table-column property="contractCode" key="contractCode" align="center" label="合同编号" min-width="150"></el-table-column>
                <el-table-column property="timeStart" key="timeStart" align="center" label="合同生效时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinish" key="timeFinish" align="center" label="合同终止时间" min-width="150"></el-table-column>
                <el-table-column property="desc" key="desc" align="center" label="合同备注" min-width="150"></el-table-column>
            </template>
            <!--车辆订单-直购-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='zgdr'">
                <el-table-column property="lessorName" key="lessorName" align="center" label="出租方" min-width="150"></el-table-column>
                <el-table-column property="customerType" key="customerType" align="center" label="客户类型" min-width="150"></el-table-column>
                <el-table-column property="customerName" key="customerName" align="center" label="客户名称" min-width="150"></el-table-column>
                <el-table-column property="contactPerson" key="contactPerson" align="center" label="联系人" min-width="150"></el-table-column>
                <el-table-column property="customerTel" key="customerTel" align="center" label="联系电话" min-width="150"></el-table-column>
                <el-table-column property="licenseNumber" key="licenseNumber" align="center" label="营业执照号" min-width="150"></el-table-column>
                <el-table-column property="idcard" key="idcard" align="center" label="身份证号" min-width="150"></el-table-column>
                <el-table-column property="customerAddr" key="customerAddr" align="center" label="联系地址" min-width="150"></el-table-column>
                <el-table-column property="customerDesc" key="customerDesc" align="center" label="客户备注" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>

                <el-table-column property="totalPrice" key="totalPrice" align="center" label="车辆总单价/元/台" min-width="150"></el-table-column>
                <el-table-column property="timeRepayment" key="timeRepayment" align="center" label="付款时间" min-width="150"></el-table-column>

                <el-table-column property="channelName" key="channelName" align="center" label="所属渠道" min-width="150"></el-table-column>
                <el-table-column property="orderDesc" key="orderDesc" align="center" label="订单备注" min-width="150"></el-table-column>

                <el-table-column property="operationName" key="operationName" align="center" label="提单人员" min-width="150"></el-table-column>
                <el-table-column property="timeDelivery" key="timeDelivery" align="center" label="交车时间" min-width="150"></el-table-column>
                <el-table-column property="deliveryOperationName" key="deliveryOperationName" align="center" label="交车人员" min-width="150"></el-table-column>
                <el-table-column property="deliveryDesc" key="deliveryDesc" align="center" label="交车备注" min-width="150"></el-table-column>

                <el-table-column property="contractCode" key="contractCode" align="center" label="合同编号" min-width="150"></el-table-column>
                <el-table-column property="timeStart" key="timeStart" align="center" label="合同生效时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinish" key="timeFinish" align="center" label="合同终止时间" min-width="150"></el-table-column>
                <el-table-column property="desc" key="desc" align="center" label="合同备注" min-width="150"></el-table-column>
            </template>
            <!--车辆订单-挂靠-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='gkdr'">
                <el-table-column property="lessorName" key="lessorName" align="center" label="出租方" min-width="150"></el-table-column>
                <el-table-column property="customerType" key="customerType" align="center" label="客户类型" min-width="150"></el-table-column>
                <el-table-column property="customerName" key="customerName" align="center" label="客户名称" min-width="150"></el-table-column>
                <el-table-column property="contactPerson" key="contactPerson" align="center" label="联系人" min-width="150"></el-table-column>
                <el-table-column property="customerTel" key="customerTel" align="center" label="联系电话" min-width="150"></el-table-column>
                <el-table-column property="licenseNumber" key="licenseNumber" align="center" label="营业执照号" min-width="150"></el-table-column>
                <el-table-column property="idcard" key="idcard" align="center" label="身份证号" min-width="150"></el-table-column>
                <el-table-column property="customerAddr" key="customerAddr" align="center" label="联系地址" min-width="150"></el-table-column>
                <el-table-column property="customerDesc" key="customerDesc" align="center" label="客户备注" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>

                <el-table-column property="monthlyRent" key="monthlyRent" align="center" label="挂靠费/元/台" min-width="150"></el-table-column>
                <el-table-column property="paymentMethod" key="paymentMethod" align="center" label="付款方式" min-width="150"></el-table-column>
                <el-table-column property="timeStartRent" key="timeStartRent" align="center" label="租赁开始时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinishRent" key="timeFinishRent" align="center" label="租赁结束时间" min-width="150"></el-table-column>
                <el-table-column property="paymentDay" key="paymentDay" align="center" label="还款日" min-width="150"></el-table-column>
                <el-table-column property="channelName" key="channelName" align="center" label="所属渠道" min-width="150"></el-table-column>
                <el-table-column property="orderDesc" key="orderDesc" align="center" label="订单备注" min-width="150"></el-table-column>

                <el-table-column property="operationName" key="operationName" align="center" label="提单人员" min-width="150"></el-table-column>
                <el-table-column property="timeDelivery" key="timeDelivery" align="center" label="交车时间" min-width="150"></el-table-column>
<!--                <el-table-column property="address" align="center" label="已退车时间" min-width="150"></el-table-column>-->
                <el-table-column property="deliveryOperationName" key="deliveryOperationName" min-width="150"></el-table-column>
                <el-table-column property="deliveryDesc" key="deliveryDesc" align="center" label="交车备注" min-width="150"></el-table-column>

                <el-table-column property="contractCode" key="contractCode" align="center" label="合同编号" min-width="150"></el-table-column>
                <el-table-column property="timeStart" key="timeStart" align="center" label="合同生效时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinish" key="timeFinish" align="center" label="合同终止时间" min-width="150"></el-table-column>
                <el-table-column property="desc" key="desc" align="center" label="合同备注" min-width="150"></el-table-column>
            </template>
            <!--车辆订单-直营-->
            <template v-else-if="currentRecordObj&&currentRecordObj.type=='zydr'">
                <el-table-column property="lessorName" key="lessorName" align="center" label="出租方" min-width="150"></el-table-column>
                <el-table-column property="customerType" key="customerType" align="center" label="客户类型" min-width="150"></el-table-column>
                <el-table-column property="customerName" key="customerName" align="center" label="客户名称" min-width="150"></el-table-column>
                <el-table-column property="contactPerson" key="contactPerson" align="center" label="联系人" min-width="150"></el-table-column>
                <el-table-column property="customerTel" key="customerTel" align="center" label="联系电话" min-width="150"></el-table-column>
                <el-table-column property="licenseNumber" key="licenseNumber" align="center" label="营业执照号" min-width="150"></el-table-column>
                <el-table-column property="idcard" key="idcard" align="center" label="身份证号" min-width="150"></el-table-column>
                <el-table-column property="customerAddr" key="customerAddr" align="center" label="联系地址" min-width="150"></el-table-column>
                <el-table-column property="customerDesc" key="customerDesc" align="center" label="客户备注" min-width="150"></el-table-column>
                <el-table-column property="vinNo" key="vinNo" align="center" label="车架号" min-width="150"></el-table-column>
                <el-table-column property="carNo" key="carNo" align="center" label="车牌号" min-width="150"></el-table-column>

                <el-table-column property="cashDeposit" key="cashDeposit" align="center" label="保证金/元/台" min-width="150"></el-table-column>
                <el-table-column property="cashDepositPeriods" key="cashDepositPeriods" align="center" label="保证金分期数" min-width="150"></el-table-column>
                <el-table-column property="targetAmount" key="targetAmount" align="center" label="达标额/元/天" min-width="150"></el-table-column>
                <el-table-column property="yesTargetAmount" key="yesTargetAmount" align="center" label="达标使用费/元/台" min-width="150"></el-table-column>
                <el-table-column property="noTargetAmount" key="noTargetAmount" align="center" label="不达标使用费/元/台" min-width="150"></el-table-column>
                <el-table-column property="freeDays" key="freeDays" align="center" label="免费用车天数" min-width="150"></el-table-column>
                <el-table-column property="paymentMethod" key="paymentMethod" align="center" label="付款方式" min-width="150"></el-table-column>
                <el-table-column property="timeStartRent" key="timeStartRent" align="center" label="租赁开始时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinishRent" key="timeFinishRent" align="center" label="租赁结束时间" min-width="150"></el-table-column>
                <el-table-column property="address" align="center" label="还款日" min-width="150"></el-table-column>
                <el-table-column property="channelName" key="channelName" align="center" label="所属渠道" min-width="150"></el-table-column>
                <el-table-column property="orderDesc" key="orderDesc" align="center" label="订单备注" min-width="150"></el-table-column>

                <el-table-column property="operationName" key="operationName" align="center" label="提单人员" min-width="150"></el-table-column>
                <el-table-column property="timeDelivery" key="timeDelivery" align="center" label="交车时间" min-width="150"></el-table-column>
                <el-table-column property="timeReturn" key="timeReturn" align="center" label="已退车时间" min-width="150"></el-table-column>
                <el-table-column property="deliveryOperationName" key="deliveryOperationName" min-width="150"></el-table-column>
                <el-table-column property="deliveryDesc" key="deliveryDesc" align="center" label="交车备注" min-width="150"></el-table-column>

                <el-table-column property="contractCode" key="contractCode" align="center" label="合同编号" min-width="150"></el-table-column>
                <el-table-column property="timeStart" key="timeStart" align="center" label="合同生效时间" min-width="150"></el-table-column>
                <el-table-column property="timeFinish" key="timeFinish" align="center" label="合同终止时间" min-width="150"></el-table-column>
                <el-table-column property="desc" key="desc" align="center" label="合同备注" min-width="150"></el-table-column>
            </template>

        </el-table>
        <div slot="footer" class="dialog-footer">
            <el-button @click="close">返回</el-button>
            <el-button type="primary" @click="dialogFormVisible = false">下载失败数据</el-button>
        </div>
    </el-dialog>

</div>





</body>
<script type="text/javascript" src="../../statics/plugins/jquery.min.js"></script>
<script src="../../statics/js/modules/import/vue.min.js?_${.now?long}"></script>
<script type="text/javascript" src="../../statics/common/layui/layui.all.js"></script>
<script src="../../statics/js/modules/element-ui/index.js"></script>
<script type="text/javascript" src="../../statics/js/common.js"></script>
<script type="text/javascript" src="../../statics/js/upload.js"></script>
<script src="../../statics/js/modules/import/import.js?_${.now?long}"></script>

<script type="text/javascript">

    new Vue({
        el: '#app',
        data() {
            return {
                tab: ['导入车辆信息', '导入车辆订单信息', '导入客户信息','导入车辆保险信息','导入车辆年检信息','导入车辆保养信息','导入车辆出险信息',
                    '导入车辆维修信息'
                    ,'导入车辆行驶证'
                ],
                currentTab: 0,
                status: 1, // {1上传，2进度，3失败,4成功,5上传zip}
                importUrl:`../../../`,
                currentTabComponent:'import-download',
                progress:0,
                activeName:'1',
                page: 1,
                limit: 10,
                totalCount:0,
                importRecords:[],
                dialogTableVisible:false,
                importList:[],
                currentRecordObj:null, //当前操作的导入结果记录项
                interval:null
            }
        },

        mounted(){
            console.log(this.importUrl,this.currentTabComponent);
            this.getList();
        },
        methods: {
            filterUrl(url) {
                return this.importUrl + url
            },
            downError(item){
                let that = this
                $.ajax({
                    type: "GET",
                    url: baseURL + "import/taskrecord/queryByNumber",
                    // contentType: "application/json",
                    data: {
                        numberNo:item.importBizNo
                    },
                    success: function(r){
                        if(r.code==0){
                            if(r.data){
                                window.location.href = baseURL + 'import/taskrecord/downXlsErr?numberNo='+item.importBizNo;
                            }else{
                                alert("已过期，无法下载")
                            }
                        }else {
                            alert(r.msg);
                        }
                    }
                });
            },
            importComplete(data){
              this.activeName = '2';
                // window.scrollTo({
                //     left: 0,
                //     top: 0,
                //     behavior: 'smooth'
                // })

                this.$message({
                    message: '导入中',
                    type: 'warning'
                });


              this.page = 1;
              this.getList();
            },
            handleSizeChange(val){
                this.limit = val;
                this.getList();
            },
            handleCurrentChange(val){
                this.page = val;
                this.getList();
            },
            getList(){
                let that = this
                $.ajax({
                    type: "GET",
                    url: baseURL + "import/taskrecord/list",
                    // contentType: "application/json",
                    data: {
                        page:this.page,
                        limit:this.limit,
                        // importBizType:"jzdr"
                        importBizType:['cldr', 'dddr', 'khdr', 'bxdr', 'clnjdr', 'bydr', 'cxdr', 'wxdr', 'xszdr'][this.currentTab]
                    },
                    success: function(r){
                        if(r.code==0){
                            that.importRecords = r.data
                            that.totalCount = Number(r.count)

                            if(that.importRecords && that.importRecords.length>0){
                                let find = that.importRecords.find(item=>item.importStatus==0);
                                if(find){
                                    that.startInterval();
                                }else {
                                    that.removeInterval();
                                }
                            }else {
                                that.removeInterval();
                            }
                        }else {
                            that.removeInterval();
                        }
                    },
                    error:function (r){
                        that.removeInterval();
                    }
                });
            },
            startInterval(){
                clearInterval(this.interval);
                this.interval = setInterval(()=>{
                    this.getList();
                }, 5000);
            },
            removeInterval(){
                if(this.interval){
                    clearInterval(this.interval)
                    this.interval=null
                }
            },

            tabChange(index) {
                this.currentTab = index;
                if(this.currentTab == 8){
                    this.status = 5;
                    this.currentTabComponent = 'import-upload';
                } else {
                    this.status = 1;
                    this.currentTabComponent = 'import-download';
                }
                this.page = 1;
                this.getList();
            },
            changeStatus(data){
                this.status = data.status;
                this.currentTabComponent = data.currentTabComponent;
                if(data.progress){
                    this.progress = data.progress;
                }
            },
            //查看导入结果详情
            goImportDetail(item){
                this.currentRecordObj=item
                this.dialogTableVisible=true
            },
            //关闭导入失败详情页面
            close(){
                this.dialogTableVisible=false
            }

        },
    })
</script>
